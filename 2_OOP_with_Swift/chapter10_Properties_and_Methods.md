# 9. 프로퍼티와 메서드

- 프로퍼티: 클래스, 구조체 또는 열겨형 등에 관련된 값

- 메서드: 특정 타입에 관련된 함수

<br>

## 10.1 프로퍼티

- 저장 프로퍼티(Stored Properties): 인스턴스의 변수 또는 상수
- 연산 프로퍼티(Conputed Properties): 값을 저장한 것이 아니라 특정 연살을 실행한 결괏값을 의미
- 타입  프로퍼티(Type Properties): 특정 타입에 사용되는 프로퍼티(인스턴스를 만들지않고 사용)


### 저장 프로퍼티
- 인스턴스와 연관된 값을 저장하는 가장 단순한 개념
- 인스턴스를 생성할 때 프로퍼티에 값이 필요 없다면 옵셔널로 선언

### 지연 저장 프로퍼티(Lazy Stored Properties)
- 필요할 때 값을 할당
- 호출이 있어야 값을 초기화한다.
- lazy 키워드 사용
- 상수는 인스턴스가 완전히 생성되기 전에 초기화 해야하므로 var 키워드를 사용해야한다.
- 다중 스레드 환경에서 동시다발적으로 접근시 `여러 번 초기화될 수 있다.`

### 연산 프로퍼티
- 특정 상태에 따른 값을 연산하는 프로퍼티
- 접근자(getter): 인스턴스 내/외부의 값을 연산하여 적절한 값을 돌려준다.
- 설정자(setter): 은닉화된 내부의 프로퍼티 값을 간접적으로 설정한다. 
- 두 메서드(접근, 설정하는)를 간결하고 확실하게 표현할 수 있다.(p 202)
  - 하나의 프로퍼티에 접근자, 설정자가 모두 모여있다.
  - 어떤 역할을 하는지 명확하게 표현 가능.
  - 인스턴스를 사용하는 입장에서도 저장 프로퍼티인 것처럼 사용

### 프로퍼티 감시자(Property Observers)
- 프로퍼티의 값이 변경됨에 따라 적절한 작업을 취할 수 있다.
- 변경되는 값이 현재의 값과 같더라도 호출
- 프로퍼티를 재정의해 상속받은 저장 프로퍼티 또는 연산 프로퍼티에도 적용할 수 있다.
- willSet: 프로퍼티의 값이 변경되기 직전에 호출
  - `변경될 값` 전달
  - 지정하지 않으면 `newValue` 사용
- didSet: 프로퍼티의 값이 변경된 직후에 호출
  - `변경되기 전의 값` 전달
  - 지정한지 않으면 `oldValue` 사용
  - didSet 감시자 코드 블록 내부에서 oldValue값을 참조하지 않거나 매개변수를 적어(didSet(oldValueName))주지 않으면 실행되지 않는다.

- 클래스를 상속받았다면 기존의 연산 프로퍼티를 재정의하여 프로퍼티 감시자를 구현할 수 있다.(p 208)
  - 연산 프로퍼티를 재정의해도 기존의 연산 프로퍼티(get, set) 기능은 동작한다.

### 전역변수와 지역변수
- 연산 프로퍼티와 프로퍼티 감시자는 전역변수와 지역변수 모두에 사용 가능
- 저장변수: 전역변수 또는 지역변수
- 전역변수, 전역상수는 지연 저장 프로퍼티처럼 처음 접근할 때 최초로 연산이 이루어진다.(lazy 사용하지 않아도 된다)

### 타입 프로퍼티
- 각각의 인스턴스가 아닌 타입 자체에 속하는 프로퍼티
- 저장 타입 프로퍼티는 
  - 변수 or 상수로 선언
  - 반드시 초깃값 설정
  - 지연 연산된다.(lazy 키워드 사용하지 않아도)
  - 다중 스레드 환경 이라도 단 한번만 초기화 보장
- 연산 타입 프로퍼티
  - 변수로만 선언

### 키 경로(Key Path)
- 값을 바로 꺼내오는 것이 아니라 어떤 `프로퍼티의 위치`만 참조하도록 할 수 있다.
- `\` 와 `.` 사용해 경로 구성
  - \타입이름.경로.경로.경로
- keyPath 서브스크립트 메서드에 키 경로를 전달하여 프로퍼티에 접근 가능
- 프로토콜과 마찬가지로 타입 간의 의존성을 낮추는데 도움을 준다.
- Swift 5.2 버전부터 (SomeType) -> Value 타입의 클로저를 키 경로 표현으로 대체 가능(map, filter, compactMap 등)

<br>

## 메서드

- 특정 타입에 관련된 함수
- 스위프트에서는 구조체와 열거형이 메서드를 가질 수 있다.

### 인스턴스 메서드
- 특정 타입의 인스턴스에 속한 함수
- 인스턴스가 존재할 때만 사용 가능
- mutating
  - 구조체나 열거형 등은 값 타입이므로 메서드앞에 붙여 해당 메서드가 인스턴스 내부의 값을 변경한다는 것을 명시

#### self 프로퍼티
- 모든 인스턴스는 암시적으로 생선된 self 프로퍼티 갖는다.
- 자기 자신을 가리키는 프로퍼티
- 인스턴스를 명확히 지칭할 때 사용

#### 인스턴스를 함수처럼 호출하도록 하는 메서드 (p 223)
- callAsFunction 이름의 메서드 구현
- mutating, throws 사용가능

### 타입 메서드
- 타입 자체에 호출이 가능한 메서드
- static: 상속 후 메서드 재정의가 불가능
- class: 상속 후 메서드 재정의 가능
- 타입 매서드에서 self 프로퍼티는 타입 그 자체를 가리킨다.

